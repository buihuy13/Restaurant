localhost:8443 {

    tls internal

    handle /ws/* {
        reverse_proxy api-gateway:8080 {
            header_up Connection {http.request.header.Connection}
            header_up Upgrade {http.request.header.Upgrade}
        }
    }

    handle /socket.io/* {
        reverse_proxy api-gateway:8080 {
            header_up Connection {http.request.header.Connection}
            header_up Upgrade {http.request.header.Upgrade}
        }
    }

    @api_routes {
        path /api/*
        path /v3/api-docs/*
        path /api-docs/*
        path /oauth2/*
        path /login/*
        path /eureka/*
        path /ws/*
        path /socket.io/*
    }

    handle @api_routes {
        reverse_proxy api-gateway:8080
    }

    handle {
        reverse_proxy frontend:3000
    }
}